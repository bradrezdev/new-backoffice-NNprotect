# üìò Documentaci√≥n Completa: Estructura UI Admin Panel

## üéØ Objetivo
Este documento explica **paso a paso** c√≥mo funciona la UI del Admin Panel, desde los conceptos b√°sicos de Reflex hasta la implementaci√≥n completa del CRUD de usuarios.

---

## üìö Tabla de Contenidos
1. [Conceptos B√°sicos de Reflex](#1-conceptos-b√°sicos-de-reflex)
2. [Estructura de Archivos](#2-estructura-de-archivos)
3. [Componentes Reutilizables](#3-componentes-reutilizables)
4. [Estado y Eventos](#4-estado-y-eventos)
5. [UI del CRUD de Usuarios](#5-ui-del-crud-de-usuarios)
6. [Flujo Completo de Datos](#6-flujo-completo-de-datos)

---

## 1. Conceptos B√°sicos de Reflex

### ¬øQu√© es Reflex?
Reflex es un framework de Python para crear aplicaciones web **reactivas** (como React, pero en Python puro).

### Conceptos Clave:

#### 1.1. Componentes (`rx.Component`)
Todo en Reflex es un **componente**. Un componente es una funci√≥n Python que retorna elementos visuales.

```python
def mi_componente() -> rx.Component:
    """
    -> rx.Component significa que esta funci√≥n retorna un elemento visual
    
    Es como decir: "Esta funci√≥n devuelve algo que se puede mostrar en pantalla"
    """
    return rx.text("Hola Mundo")
```

#### 1.2. Contenedores
Los contenedores organizan otros componentes:

**`rx.vstack`** = Vertical Stack (apila elementos verticalmente)
```python
rx.vstack(
    rx.text("Elemento 1"),  # ‚¨ÜÔ∏è Arriba
    rx.text("Elemento 2"),  # ‚¨áÔ∏è Abajo
    spacing="4"  # Espacio entre elementos (4 = 1rem)
)
```

**`rx.hstack`** = Horizontal Stack (apila elementos horizontalmente)
```python
rx.hstack(
    rx.text("Izquierda"),   # ‚¨ÖÔ∏è
    rx.text("Derecha"),     # ‚û°Ô∏è
    spacing="2"
)
```

**`rx.box`** = Caja flexible (como un `<div>` en HTML)
```python
rx.box(
    rx.text("Contenido"),
    padding="1rem",      # Espacio interno
    background="white",  # Color de fondo
    border_radius="8px"  # Esquinas redondeadas
)
```

#### 1.3. El Asterisco (*) - Desempaquetado
```python
# ‚ùå SIN asterisco - ERROR
elementos = [rx.text("A"), rx.text("B")]
rx.vstack(elementos)  # Esto NO funciona

# ‚úÖ CON asterisco - CORRECTO
elementos = [rx.text("A"), rx.text("B")]
rx.vstack(*elementos)  # Desempaqueta la lista
# Equivale a: rx.vstack(rx.text("A"), rx.text("B"))
```

**¬øPor qu√©?**
- `rx.vstack()` espera recibir componentes **separados**, no una lista
- El `*` "desempaqueta" la lista y pasa cada elemento como argumento separado

**Analog√≠a:**
```python
# Es como hacer:
caja_de_galletas = ["galleta1", "galleta2", "galleta3"]

# Sin asterisco: pasas la caja entera
dar_galletas(caja_de_galletas)  # Recibe: [galleta1, galleta2, galleta3]

# Con asterisco: sacas las galletas de la caja
dar_galletas(*caja_de_galletas)  # Recibe: galleta1, galleta2, galleta3
```

---

## 2. Estructura de Archivos

```
Admin_app/
‚îú‚îÄ‚îÄ admin_state.py       # üß† L√ìGICA: Estado y funciones de negocio
‚îú‚îÄ‚îÄ admin_page.py        # üé® UI: Componentes visuales
‚îú‚îÄ‚îÄ components.py        # üß© COMPONENTES: Elementos reutilizables
‚îî‚îÄ‚îÄ theme.py            # üé® TEMA: Colores y estilos
```

### 2.1. Separaci√≥n de Responsabilidades

**admin_state.py** (El Cerebro):
```python
class AdminState(rx.State):
    """
    Estado = Variables que la UI puede leer y modificar
    
    Pi√©nsalo como una "base de datos en memoria" que:
    - Almacena datos temporales
    - Ejecuta l√≥gica de negocio
    - Se sincroniza autom√°ticamente con la UI
    """
    
    # Variable de estado (dato)
    search_user_query: str = ""
    
    # Setter (funci√≥n que modifica el dato)
    def set_search_user_query(self, value: str):
        """
        Cuando el usuario escribe en un input,
        esta funci√≥n actualiza la variable
        """
        self.search_user_query = value
    
    # Evento (funci√≥n que ejecuta l√≥gica compleja)
    @rx.event
    def search_user(self):
        """
        @rx.event = Decorador que marca esta funci√≥n como "evento"
        
        Un evento es una funci√≥n que:
        1. Puede ser llamada desde la UI (botones, formularios)
        2. Puede hacer operaciones pesadas (consultas DB)
        3. Actualiza el estado cuando termina
        """
        # L√≥gica de b√∫squeda...
        pass
```

**admin_page.py** (La Cara):
```python
def tab_search_user() -> rx.Component:
    """
    Componente visual que:
    - Lee datos del estado (AdminState.search_user_query)
    - Muestra inputs y botones
    - Llama eventos cuando el usuario interact√∫a
    """
    return rx.vstack(
        # Input conectado al estado
        rx.input(
            value=AdminState.search_user_query,  # Lee del estado
            on_change=AdminState.set_search_user_query  # Escribe al estado
        ),
        # Bot√≥n que llama un evento
        rx.button(
            "Buscar",
            on_click=AdminState.search_user  # Ejecuta la b√∫squeda
        )
    )
```

---

## 3. Componentes Reutilizables

### 3.1. ¬øPor qu√© crear componentes reutilizables?
**Problema:** Repetir c√≥digo es tedioso y propenso a errores.

**Soluci√≥n:** Crear funciones que generen componentes con estilos consistentes.

### 3.2. Ejemplo: `admin_input`

**En `components.py`:**
```python
def admin_input(
    label: str,           # Texto de la etiqueta
    placeholder: str,     # Texto de ejemplo en el input
    value,               # Valor actual (viene del estado)
    on_change,           # Funci√≥n que se ejecuta al escribir
    input_type: str = "text"  # Tipo de input (text, number, email...)
) -> rx.Component:
    """
    Componente reutilizable para inputs del admin panel.
    
    VENTAJAS:
    - Estilos consistentes en toda la app
    - Cambiar el dise√±o en un solo lugar
    - C√≥digo m√°s limpio y legible
    
    PAR√ÅMETROS:
    - label: Texto que aparece arriba del input
    - placeholder: Texto gris dentro del input (ej: "Escribe aqu√≠...")
    - value: Variable del estado que almacena lo que escribe el usuario
    - on_change: Funci√≥n que actualiza el estado cuando el usuario escribe
    - input_type: Tipo de input (text=texto, number=n√∫meros, email=correo)
    
    RETORNA:
    - rx.Component: Un contenedor vertical con label + input estilizado
    """
    return rx.vstack(
        # Etiqueta del input
        rx.text(
            label,
            font_size="0.875rem",      # Tama√±o de fuente peque√±o (14px)
            font_weight="600",          # Texto en negritas
            color=COLORS["gray_700"],   # Color gris oscuro
            margin_bottom="0.5rem"      # Espacio debajo de la etiqueta
        ),
        
        # Input estilizado
        rx.input(
            placeholder=placeholder,    # Texto de ayuda
            value=value,               # Valor actual del input
            on_change=on_change,       # Funci√≥n al escribir
            type=input_type,           # Tipo de input
            width="100%",              # Ocupa todo el ancho disponible
            padding="0.75rem 1rem",    # Espacio interno (arriba/abajo izquierda/derecha)
            border_radius="12px",      # Esquinas redondeadas
            border=f"2px solid {COLORS['gray_300']}",  # Borde gris claro
            background="white",        # Fondo blanco
            font_size="0.95rem",      # Tama√±o de fuente
            _focus={                   # Estilos cuando el input est√° enfocado (activo)
                "border": f"2px solid {COLORS['primary']}",  # Borde azul
                "outline": "none"      # Quitar borde del navegador
            }
        ),
        
        spacing="1",  # Espacio entre label e input (0.25rem)
        width="100%"  # El contenedor ocupa todo el ancho
    )
```

### 3.3. Uso del componente

**‚ùå SIN componente reutilizable:**
```python
# Hay que repetir TODO este c√≥digo cada vez
rx.vstack(
    rx.text("Nombre", font_size="0.875rem", font_weight="600"...),
    rx.input(placeholder="Tu nombre", value=..., on_change=...),
    spacing="1"
)

rx.vstack(
    rx.text("Email", font_size="0.875rem", font_weight="600"...),
    rx.input(placeholder="Tu email", value=..., on_change=...),
    spacing="1"
)
```

**‚úÖ CON componente reutilizable:**
```python
# C√≥digo limpio y legible
admin_input("Nombre", "Tu nombre", AdminState.name, AdminState.set_name)
admin_input("Email", "Tu email", AdminState.email, AdminState.set_email)
```

---

## 4. Estado y Eventos

### 4.1. Variables de Estado

```python
class AdminState(rx.State):
    """
    Estado = Variables que React(ive) puede observar
    
    Cuando una variable de estado cambia:
    1. Reflex detecta el cambio autom√°ticamente
    2. Re-renderiza la UI para reflejar el nuevo valor
    3. Todo esto pasa sin recargar la p√°gina
    """
    
    # ==================== TIPOS DE VARIABLES ====================
    
    # String (texto)
    search_user_query: str = ""
    """
    : str = Anotaci√≥n de tipo (dice que es texto)
    = ""  = Valor inicial (comienza vac√≠o)
    
    Esta variable almacena lo que el usuario escribe en el input
    """
    
    # Boolean (verdadero/falso)
    is_loading_search: bool = False
    """
    : bool = Es un booleano (True o False)
    = False = Comienza en falso
    
    Controla si se muestra el spinner de carga
    """
    
    # Lista de objetos
    search_user_organization: list[OrganizationMember] = []
    """
    : list[OrganizationMember] = Lista que contiene objetos tipo OrganizationMember
    = [] = Comienza vac√≠a
    
    Almacena los resultados de la b√∫squeda
    """
    
    # Campos individuales para el resultado
    result_nombre: str = ""
    result_email: str = ""
    result_pais: str = ""
    """
    Separamos los datos en campos individuales porque:
    - Reflex tiene problemas con diccionarios en la UI
    - Es m√°s f√°cil acceder a AdminState.result_nombre
    - Evita errores de compilaci√≥n
    """
```

### 4.2. Setters (Funciones que Modifican el Estado)

```python
def set_search_user_query(self, value: str):
    """
    Setter = Funci√≥n que modifica una variable de estado
    
    PAR√ÅMETROS:
    - self: Referencia a la instancia del estado
    - value: str = Nuevo valor que viene del input
    
    FLUJO:
    1. Usuario escribe "1" en el input
    2. El input llama: on_change=AdminState.set_search_user_query
    3. Esta funci√≥n recibe value="1"
    4. Actualiza self.search_user_query = "1"
    5. Reflex detecta el cambio y actualiza la UI
    """
    self.search_user_query = value
```

### 4.3. Eventos (Funciones con L√≥gica Compleja)

```python
@rx.event
def search_user(self):
    """
    @rx.event = Decorador que marca esta funci√≥n como "evento"
    
    ¬øQu√© hace el decorador?
    - Permite que la funci√≥n sea llamada desde la UI
    - Maneja la sincronizaci√≥n con el frontend
    - Actualiza la UI autom√°ticamente cuando termina
    
    ESTRUCTURA DE UN EVENTO:
    1. Cambiar estado inicial (ej: is_loading=True)
    2. Ejecutar l√≥gica (consultas DB, c√°lculos)
    3. Actualizar estado con resultados
    4. Cambiar estado final (ej: is_loading=False)
    """
    
    # 1Ô∏è‚É£ Estado inicial
    self.is_loading_search = True
    self.has_result = False
    
    try:
        # 2Ô∏è‚É£ L√≥gica de negocio
        query = self.search_user_query.strip()
        member_id = int(query)
        
        # Consulta a la base de datos
        with rx.session() as session:
            user = session.exec(
                sqlmodel.select(Users)
                .where(Users.member_id == member_id)
            ).first()
        
        # 3Ô∏è‚É£ Actualizar estado con resultados
        if user:
            self.result_nombre = f"{user.first_name} {user.last_name}"
            self.result_email = user.email_cache or "N/A"
            self.has_result = True
        else:
            self.show_error("Usuario no encontrado")
    
    except Exception as e:
        self.show_error(f"Error: {str(e)}")
    
    finally:
        # 4Ô∏è‚É£ Estado final (siempre se ejecuta)
        self.is_loading_search = False
```

---

## 5. UI del CRUD de Usuarios

### 5.1. Estructura Completa con Comentarios

```python
def tab_search_user() -> rx.Component:
    """
    Componente principal de la tab "Buscar Usuario"
    
    ESTRUCTURA VISUAL:
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ [T√≠tulo]                            ‚îÇ
    ‚îÇ [Subt√≠tulo]                         ‚îÇ
    ‚îÇ                                     ‚îÇ
    ‚îÇ [Input: Member ID]  [Bot√≥n Buscar] ‚îÇ
    ‚îÇ                                     ‚îÇ
    ‚îÇ [Tabla: Info del Usuario]          ‚îÇ <- Solo si hay resultado
    ‚îÇ                                     ‚îÇ
    ‚îÇ [Tabla: Organizaci√≥n]              ‚îÇ <- Solo si hay resultado
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    
    RETORNA:
    - rx.Component: Contenedor vertical con todos los elementos
    """
    return rx.vstack(
        # ================== 1. ENCABEZADO ==================
        section_title(
            "Buscar Usuario",
            "Busca por Member ID para ver su informaci√≥n y organizaci√≥n"
        ),
        """
        section_title() es una funci√≥n helper que retorna:
        - Un t√≠tulo grande
        - Un subt√≠tulo peque√±o
        - Estilos consistentes
        
        Definida en components.py o theme.py
        """
        
        # ================== 2. BUSCADOR ==================
        rx.hstack(
            """
            rx.hstack = Horizontal Stack
            Coloca elementos uno al lado del otro (‚¨ÖÔ∏è‚û°Ô∏è)
            """
            
            # Input para el Member ID
            admin_input(
                "Member ID*",                      # Label (etiqueta)
                placeholder="Ej: 1",               # Texto de ayuda
                value=AdminState.search_user_query, # Valor actual
                on_change=AdminState.set_search_user_query, # Funci√≥n al escribir
                input_type="number"                # Solo acepta n√∫meros
            ),
            """
            FLUJO DEL INPUT:
            1. Usuario escribe "5"
            2. on_change llama a set_search_user_query("5")
            3. AdminState.search_user_query = "5"
            4. El input se actualiza y muestra "5"
            """
            
            # Bot√≥n de b√∫squeda
            admin_button(
                "üîç Buscar",                      # Texto del bot√≥n
                on_click=AdminState.search_user,  # Evento al hacer clic
                disabled=AdminState.is_loading_search, # Deshabilitado si est√° cargando
                width="auto"                       # Ancho autom√°tico (no 100%)
            ),
            """
            FLUJO DEL BOT√ìN:
            1. Usuario hace clic
            2. on_click ejecuta AdminState.search_user()
            3. El m√©todo busca en la DB
            4. Actualiza las variables de resultado
            5. La UI se re-renderiza autom√°ticamente
            
            disabled=AdminState.is_loading_search:
            - Si is_loading_search=True ‚Üí Bot√≥n deshabilitado (gris)
            - Si is_loading_search=False ‚Üí Bot√≥n habilitado (azul)
            """
            
            spacing="2",  # Espacio entre input y bot√≥n (0.5rem)
            width="100%", # Ocupa todo el ancho disponible
            max_width="600px" # Pero no m√°s de 600px (se centra)
        ),
        
        # ================== 3. RESULTADO DEL USUARIO ==================
        rx.cond(
            """
            rx.cond = Condicional (if/else en Reflex)
            
            Sintaxis:
            rx.cond(
                condici√≥n,        # Si esto es True...
                componente_true,  # Muestra esto
                componente_false  # Si es False, muestra esto (opcional)
            )
            """
            
            AdminState.has_result,  # CONDICI√ìN: ¬øHay resultado?
            """
            has_result es un boolean:
            - True: Usuario encontrado ‚Üí Muestra las tablas
            - False: No hay usuario ‚Üí No muestra nada
            """
            
            # üëá SI hay resultado, muestra esto:
            rx.vstack(
                # -------- T√≠tulo de la secci√≥n --------
                rx.heading(
                    "Informaci√≥n del Usuario",
                    font_size="1.25rem",       # 20px
                    font_weight="600",          # Semi-bold
                    color=COLORS["gray_900"],   # Gris muy oscuro
                    margin_top="2rem"           # Espacio arriba (32px)
                ),
                
                # -------- Tabla con scroll horizontal --------
                rx.scroll_area(
                    """
                    rx.scroll_area = Contenedor con scroll
                    
                    ¬øPor qu√©?
                    La tabla puede ser muy ancha (1200px)
                    En m√≥viles/tablets no cabe
                    El scroll permite desplazarse horizontalmente ‚¨ÖÔ∏è‚û°Ô∏è
                    """
                    
                    rx.box(
                        """
                        rx.box = Contenedor flexible
                        Envuelve la tabla para aplicar estilos
                        """
                        
                        rx.table.root(
                            """
                            rx.table.root = Componente de tabla de Reflex
                            
                            ESTRUCTURA:
                            table.root
                            ‚îú‚îÄ‚îÄ table.header (encabezados)
                            ‚îÇ   ‚îî‚îÄ‚îÄ table.row
                            ‚îÇ       ‚îî‚îÄ‚îÄ table.column_header_cell (cada columna)
                            ‚îî‚îÄ‚îÄ table.body (contenido)
                                ‚îî‚îÄ‚îÄ table.row (cada fila)
                                    ‚îî‚îÄ‚îÄ table.cell (cada celda)
                            """
                            
                            # Encabezados
                            rx.table.header(
                                rx.table.row(
                                    rx.table.column_header_cell("Member ID"),
                                    rx.table.column_header_cell("Nombre"),
                                    rx.table.column_header_cell("Email"),
                                    rx.table.column_header_cell("Tel√©fono"),
                                    rx.table.column_header_cell("Sponsor ID"),
                                    rx.table.column_header_cell("Sponsor Nombre"),
                                    rx.table.column_header_cell("Pa√≠s"),
                                    rx.table.column_header_cell("Ciudad"),
                                    rx.table.column_header_cell("Estado Postal"),
                                    rx.table.column_header_cell("Fecha Registro"),
                                    rx.table.column_header_cell("Estatus"),
                                )
                            ),
                            
                            # Contenido (una sola fila con los datos)
                            rx.table.body(
                                rx.table.row(
                                    """
                                    Cada table.cell muestra un campo del resultado
                                    
                                    AdminState.result_nombre:
                                    - Lee la variable del estado
                                    - Muestra su valor en la celda
                                    - Si cambia, la UI se actualiza autom√°ticamente
                                    """
                                    rx.table.cell(AdminState.result_member_id),
                                    rx.table.cell(AdminState.result_nombre),
                                    rx.table.cell(AdminState.result_email),
                                    rx.table.cell(AdminState.result_telefono),
                                    rx.table.cell(AdminState.result_sponsor_id),
                                    rx.table.cell(AdminState.result_sponsor_nombre),
                                    rx.table.cell(AdminState.result_pais),
                                    rx.table.cell(AdminState.result_ciudad),
                                    rx.table.cell(AdminState.result_estado_postal),
                                    rx.table.cell(AdminState.result_fecha_registro),
                                    rx.table.cell(AdminState.result_estatus),
                                )
                            ),
                            
                            width="100%",      # Ancho completo
                            variant="surface"  # Estilo predefinido de Reflex
                        ),
                        
                        # Estilos del contenedor de la tabla
                        padding="1rem",
                        border_radius="12px",
                        border=f"1px solid {COLORS['gray_200']}",
                        background="white",
                        min_width="1200px"  # ‚ö†Ô∏è CLAVE: Fuerza el scroll si no cabe
                        """
                        min_width="1200px":
                        - La tabla SIEMPRE tendr√° al menos 1200px de ancho
                        - Si la pantalla es m√°s peque√±a ‚Üí aparece scroll horizontal
                        - Garantiza que todas las columnas sean legibles
                        """
                    ),
                    
                    type="auto",              # Scroll autom√°tico
                    scrollbars="horizontal",  # Solo scroll horizontal ‚¨ÖÔ∏è‚û°Ô∏è
                    style={"width": "100%", "max_width": "100%"}
                    """
                    scrollbars="horizontal":
                    - Solo muestra barra de scroll horizontal
                    - No vertical (la tabla tiene una fila)
                    """
                ),
                
                # ================== 4. TABLA DE ORGANIZACI√ìN ==================
                rx.heading(
                    "Organizaci√≥n Directa",
                    font_size="1.25rem",
                    font_weight="600",
                    color=COLORS["gray_900"],
                    margin_top="2rem"
                ),
                
                rx.cond(
                    """
                    Segunda condici√≥n:
                    ¬øHay personas en la organizaci√≥n?
                    """
                    AdminState.search_user_organization,
                    """
                    Verifica si la lista tiene elementos:
                    - [] (vac√≠a) = False ‚Üí Muestra mensaje "no tiene organizaci√≥n"
                    - [item1, item2] = True ‚Üí Muestra la tabla
                    """
                    
                    # üëá SI hay organizaci√≥n, muestra tabla
                    rx.scroll_area(
                        rx.box(
                            rx.table.root(
                                rx.table.header(
                                    rx.table.row(
                                        rx.table.column_header_cell("Nombre"),
                                        rx.table.column_header_cell("Member ID"),
                                        rx.table.column_header_cell("Pa√≠s"),
                                        rx.table.column_header_cell("PV"),
                                        rx.table.column_header_cell("PVG"),
                                        rx.table.column_header_cell("Nivel"),
                                        rx.table.column_header_cell("Ciudad"),
                                    )
                                ),
                                
                                rx.table.body(
                                    rx.foreach(
                                        """
                                        rx.foreach = Bucle en Reflex (equivalente a for)
                                        
                                        Sintaxis:
                                        rx.foreach(
                                            lista,           # Lista a iterar
                                            lambda item: ... # Funci√≥n que procesa cada item
                                        )
                                        
                                        EJEMPLO:
                                        lista = [1, 2, 3]
                                        rx.foreach(lista, lambda x: rx.text(f"N√∫mero: {x}"))
                                        
                                        Genera:
                                        <text>N√∫mero: 1</text>
                                        <text>N√∫mero: 2</text>
                                        <text>N√∫mero: 3</text>
                                        """
                                        
                                        AdminState.search_user_organization,
                                        """
                                        Lista de objetos OrganizationMember:
                                        [
                                            OrganizationMember(nombre="Juan", member_id=2...),
                                            OrganizationMember(nombre="Mar√≠a", member_id=3...),
                                        ]
                                        """
                                        
                                        lambda member: rx.table.row(
                                            """
                                            lambda = Funci√≥n an√≥nima
                                            
                                            lambda member: ...
                                            - member: Cada elemento de la lista
                                            - ...: Qu√© hacer con cada elemento
                                            
                                            Por cada miembro de la organizaci√≥n:
                                            1. Toma el objeto (member)
                                            2. Extrae sus atributos (member.nombre, member.pais...)
                                            3. Crea una fila con esos datos
                                            """
                                            
                                            rx.table.cell(member.nombre),
                                            """
                                            member.nombre:
                                            - member: Objeto actual del bucle
                                            - .nombre: Atributo del objeto (definido en OrganizationMember)
                                            - Accede al valor y lo muestra
                                            """
                                            
                                            rx.table.cell(member.member_id),
                                            rx.table.cell(member.pais),
                                            rx.table.cell(member.pv),
                                            rx.table.cell(member.pvg),
                                            rx.table.cell(member.nivel),
                                            rx.table.cell(member.ciudad),
                                        )
                                    )
                                ),
                                
                                width="100%",
                                variant="surface"
                            ),
                            
                            padding="1rem",
                            border_radius="12px",
                            border=f"1px solid {COLORS['gray_200']}",
                            background="white",
                            min_width="800px"  # Fuerza scroll si no cabe
                        ),
                        
                        type="auto",
                        scrollbars="horizontal",
                        style={"width": "100%", "max_width": "100%"}
                    ),
                    
                    # üëá SI NO hay organizaci√≥n, muestra mensaje
                    rx.box(
                        rx.text(
                            "Este usuario no tiene personas en su organizaci√≥n directa.",
                            color=COLORS["gray_500"],
                            text_align="center"
                        ),
                        padding="2rem",
                        border_radius="12px",
                        border=f"1px solid {COLORS['gray_200']}",
                        background=COLORS["gray_50"]
                    )
                ),
                
                spacing="4",      # Espacio entre elementos (1rem)
                width="100%",     # Ancho completo
                max_width="100%"  # Sin l√≠mite de ancho
            )
            # üëÜ FIN del vstack que se muestra si has_result=True
        ),
        # üëÜ FIN del rx.cond
        
        spacing="4",           # Espacio entre secciones principales
        width="100%",          # Ancho completo
        max_width="100%",      # Sin l√≠mite
        padding="1rem"         # Espacio interno del contenedor
    )
```

---

## 6. Flujo Completo de Datos

### 6.1. Diagrama de Flujo: B√∫squeda de Usuario

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. USUARIO INTERACT√öA CON LA UI                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Usuario escribe "5" en el input                                 ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ <input                                                           ‚îÇ
‚îÇ   value={AdminState.search_user_query}  ‚Üê Lee: ""              ‚îÇ
‚îÇ   on_change={AdminState.set_search_user_query} ‚Üê Llama setter  ‚îÇ
‚îÇ />                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. SETTER ACTUALIZA EL ESTADO                                   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ def set_search_user_query(self, value: str):                   ‚îÇ
‚îÇ     self.search_user_query = value  # "5"                      ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ Estado actual: search_user_query = "5"                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. REFLEX ACTUALIZA LA UI AUTOM√ÅTICAMENTE                       ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ El input ahora muestra "5"                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. USUARIO HACE CLIC EN "BUSCAR"                               ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ <button                                                          ‚îÇ
‚îÇ   on_click={AdminState.search_user}  ‚Üê Llama evento            ‚îÇ
‚îÇ >                                                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 5. EVENTO EJECUTA L√ìGICA DE NEGOCIO                            ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ @rx.event                                                        ‚îÇ
‚îÇ def search_user(self):                                          ‚îÇ
‚îÇ     # A. Cambiar estado inicial                                ‚îÇ
‚îÇ     self.is_loading_search = True  ‚Üê Bot√≥n se deshabilita      ‚îÇ
‚îÇ     self.has_result = False        ‚Üê Oculta tablas             ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ     # B. Consultar base de datos                               ‚îÇ
‚îÇ     with rx.session() as session:                               ‚îÇ
‚îÇ         user = session.exec(                                    ‚îÇ
‚îÇ             select(Users).where(Users.member_id == 5)          ‚îÇ
‚îÇ         ).first()                                               ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ     # C. Actualizar estado con resultados                      ‚îÇ
‚îÇ     if user:                                                     ‚îÇ
‚îÇ         self.result_nombre = "Juan P√©rez"                      ‚îÇ
‚îÇ         self.result_email = "juan@example.com"                 ‚îÇ
‚îÇ         self.result_pais = "M√©xico"                            ‚îÇ
‚îÇ         # ... m√°s campos ...                                    ‚îÇ
‚îÇ         self.has_result = True  ‚Üê Muestra tablas               ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ     # D. Cambiar estado final                                  ‚îÇ
‚îÇ     self.is_loading_search = False  ‚Üê Habilita bot√≥n           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 6. REFLEX ACTUALIZA LA UI CON LOS NUEVOS DATOS                 ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ Cambios detectados:                                             ‚îÇ
‚îÇ - has_result: False ‚Üí True                                      ‚îÇ
‚îÇ - is_loading_search: True ‚Üí False                              ‚îÇ
‚îÇ - result_nombre: "" ‚Üí "Juan P√©rez"                             ‚îÇ
‚îÇ - result_email: "" ‚Üí "juan@example.com"                        ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ Acciones:                                                        ‚îÇ
‚îÇ - rx.cond(has_result) detecta True ‚Üí Muestra vstack con tablas‚îÇ
‚îÇ - Bot√≥n se habilita (disabled=False)                           ‚îÇ
‚îÇ - Tabla muestra los datos de AdminState.result_*               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 6.2. Flujo Visual Interactivo

```
ESTADO INICIAL (P√°gina cargada)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Buscar Usuario                           ‚îÇ
‚îÇ Busca por Member ID...                   ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ Member ID*: [        ] [üîç Buscar]      ‚îÇ
‚îÇ                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Variables de estado:
- search_user_query = ""
- has_result = False
- is_loading_search = False


USUARIO ESCRIBE "5"
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Buscar Usuario                           ‚îÇ
‚îÇ Busca por Member ID...                   ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ Member ID*: [   5    ] [üîç Buscar]      ‚îÇ
‚îÇ                        ‚Üë                 ‚îÇ
‚îÇ                  on_change llam√≥         ‚îÇ
‚îÇ                  set_search_user_query   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Variables de estado:
- search_user_query = "5"  ‚Üê CAMBI√ì
- has_result = False
- is_loading_search = False


USUARIO HACE CLIC EN BUSCAR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Buscar Usuario                           ‚îÇ
‚îÇ Busca por Member ID...                   ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ Member ID*: [   5    ] [‚è≥ Buscando...] ‚îÇ
‚îÇ                        ‚Üë                 ‚îÇ
‚îÇ                  on_click llam√≥          ‚îÇ
‚îÇ                  search_user()           ‚îÇ
‚îÇ                  disabled=True           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Variables de estado:
- search_user_query = "5"
- has_result = False
- is_loading_search = True  ‚Üê CAMBI√ì (bot√≥n deshabilitado)


B√öSQUEDA COMPLETADA
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Buscar Usuario                           ‚îÇ
‚îÇ Busca por Member ID...                   ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ Member ID*: [   5    ] [üîç Buscar]      ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ Informaci√≥n del Usuario                  ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ ‚îÇ Member ID ‚îÇ Nombre ‚îÇ Email  ‚îÇ ... ‚îÇ  ‚îÇ
‚îÇ ‚îÇ 5         ‚îÇ Juan   ‚îÇ juan@...‚îÇ    ‚îÇ  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ ‚Üê Tabla con scroll ‚Üí                    ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ Organizaci√≥n Directa                     ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ ‚îÇ Nombre ‚îÇ ID ‚îÇ Pa√≠s ‚îÇ PV ‚îÇ PVG ‚îÇ..‚îÇ  ‚îÇ
‚îÇ ‚îÇ Mar√≠a  ‚îÇ 10 ‚îÇ MX   ‚îÇ 50 ‚îÇ 50  ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ ‚îÇ Pedro  ‚îÇ 11 ‚îÇ USA  ‚îÇ 30 ‚îÇ 30  ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ ‚Üê Tabla con scroll ‚Üí                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Variables de estado:
- search_user_query = "5"
- has_result = True  ‚Üê CAMBI√ì (muestra tablas)
- is_loading_search = False  ‚Üê CAMBI√ì (bot√≥n habilitado)
- result_nombre = "Juan P√©rez"  ‚Üê CAMBI√ì
- result_email = "juan@example.com"  ‚Üê CAMBI√ì
- search_user_organization = [Mar√≠a, Pedro]  ‚Üê CAMBI√ì
```

---

## 7. Conceptos Avanzados

### 7.1. OrganizationMember: ¬øPor qu√© una clase?

**Problema con diccionarios:**
```python
# ‚ùå NO FUNCIONA en Reflex UI
org_list = [
    {"nombre": "Juan", "pais": "M√©xico"},
    {"nombre": "Mar√≠a", "pais": "USA"}
]

# En el UI:
lambda member: rx.text(member["nombre"])  # Error de compilaci√≥n
```

**Soluci√≥n con clase:**
```python
# ‚úÖ FUNCIONA
class OrganizationMember(rx.Base):
    """
    rx.Base = Clase base de Reflex para modelos de datos
    
    ¬øPor qu√© heredar de rx.Base?
    - Reflex puede serializar/deserializar la clase
    - Compatible con la UI (puede acceder a atributos)
    - Valida tipos autom√°ticamente
    """
    nombre: str
    member_id: int
    pais: str
    pv: int
    pvg: int
    nivel: int
    ciudad: str

# Crear objetos
org_list = [
    OrganizationMember(
        nombre="Juan",
        member_id=10,
        pais="M√©xico",
        pv=50,
        pvg=50,
        nivel=1,
        ciudad="CDMX"
    )
]

# En el UI (funciona perfectamente):
lambda member: rx.text(member.nombre)  # Acceso por atributo
```

### 7.2. rx.cond vs Python if

**Python if (no funciona en UI):**
```python
# ‚ùå ERROR: No se puede usar if directamente
def mi_componente():
    if AdminState.has_result:  # Esto no compila
        return rx.text("S√≠ hay resultado")
    else:
        return rx.text("No hay resultado")
```

**rx.cond (funciona en UI):**
```python
# ‚úÖ CORRECTO
def mi_componente():
    return rx.cond(
        AdminState.has_result,  # Condici√≥n
        rx.text("S√≠ hay resultado"),  # Si True
        rx.text("No hay resultado")   # Si False (opcional)
    )
```

**¬øPor qu√©?**
- Reflex necesita **rastrear** las condiciones para saber cu√°ndo re-renderizar
- `if` de Python es est√°tico (se eval√∫a una vez al cargar)
- `rx.cond` es reactivo (se re-eval√∫a cuando cambia el estado)

### 7.3. rx.foreach vs Python for

**Python for (no funciona):**
```python
# ‚ùå ERROR
def mi_tabla():
    filas = []
    for member in AdminState.search_user_organization:
        filas.append(rx.table.row(rx.table.cell(member.nombre)))
    return rx.table.body(*filas)  # No es reactivo
```

**rx.foreach (funciona):**
```python
# ‚úÖ CORRECTO
def mi_tabla():
    return rx.table.body(
        rx.foreach(
            AdminState.search_user_organization,  # Lista reactiva
            lambda member: rx.table.row(          # Funci√≥n para cada item
                rx.table.cell(member.nombre)
            )
        )
    )
```

**¬øPor qu√©?**
- `for` de Python se ejecuta una sola vez
- `rx.foreach` se re-ejecuta cuando cambia la lista
- Permite agregar/quitar elementos din√°micamente

---

## 8. Mejores Pr√°cticas

### 8.1. Nombres Descriptivos
```python
# ‚ùå MAL
def f1():
    return rx.box(...)

x = AdminState.d
y = AdminState.r

# ‚úÖ BIEN
def tab_search_user():
    return rx.box(...)

search_query = AdminState.search_user_query
has_result = AdminState.has_result
```

### 8.2. Componentes Peque√±os
```python
# ‚ùå MAL: Todo en una funci√≥n gigante
def admin_page():
    return rx.vstack(
        # 500 l√≠neas de c√≥digo...
    )

# ‚úÖ BIEN: Dividir en componentes peque√±os
def admin_page():
    return rx.vstack(
        admin_header(),
        admin_tabs(),
        admin_footer()
    )

def admin_tabs():
    return rx.tabs(
        tab_search_user(),
        tab_create_account(),
        # ...
    )
```

### 8.3. Comentarios √ötiles
```python
# ‚ùå MAL: Comentarios obvios
width="100%"  # Ancho 100%

# ‚úÖ BIEN: Comentarios que explican el "por qu√©"
width="100%"  # Ocupa todo el ancho para que el scroll funcione en m√≥viles
```

---

## 9. Resumen Ejecutivo

### Conceptos Clave:
1. **Componentes**: Funciones que retornan elementos visuales
2. **Estado**: Variables que React(ive) observa y sincroniza con la UI
3. **Eventos**: Funciones marcadas con `@rx.event` que ejecutan l√≥gica de negocio
4. **Condicionales**: `rx.cond` para mostrar/ocultar elementos seg√∫n el estado
5. **Bucles**: `rx.foreach` para iterar sobre listas de forma reactiva
6. **Desempaquetado**: `*` para pasar lista de argumentos como argumentos separados

### Flujo de Datos:
```
Usuario interact√∫a ‚Üí Setter actualiza estado ‚Üí Reflex detecta cambio ‚Üí UI se actualiza
```

### Jerarqu√≠a de Componentes:
```
admin_page
‚îú‚îÄ‚îÄ admin_header
‚îú‚îÄ‚îÄ admin_tabs
‚îÇ   ‚îú‚îÄ‚îÄ tab_search_user
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ section_title
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin_input
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin_button
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ rx.table (con datos del estado)
‚îÇ   ‚îú‚îÄ‚îÄ tab_create_account
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ admin_footer
```

### Conexi√≥n Estado-UI:
- **Lectura**: `value={AdminState.campo}` ‚Üí UI lee del estado
- **Escritura**: `on_change={AdminState.set_campo}` ‚Üí UI escribe al estado
- **Eventos**: `on_click={AdminState.metodo}` ‚Üí UI ejecuta l√≥gica

---

## 10. Glosario

| T√©rmino | Significado | Ejemplo |
|---------|-------------|---------|
| **Componente** | Funci√≥n que retorna elementos visuales | `def mi_btn() -> rx.Component` |
| **Estado** | Variables observables que sincronizan con la UI | `name: str = ""` |
| **Setter** | Funci√≥n que modifica una variable de estado | `def set_name(self, v): self.name = v` |
| **Evento** | Funci√≥n con l√≥gica compleja marcada con `@rx.event` | `@rx.event def search()` |
| **Desempaquetado** | Operador `*` que convierte lista en argumentos | `rx.vstack(*lista)` |
| **rx.cond** | Condicional reactivo (if/else) | `rx.cond(estado, si_true, si_false)` |
| **rx.foreach** | Bucle reactivo (for) | `rx.foreach(lista, lambda x: ...)` |
| **rx.Base** | Clase base para modelos de datos en Reflex | `class User(rx.Base)` |
| **Stack** | Contenedor que apila elementos | `rx.vstack` (vertical), `rx.hstack` (horizontal) |
| **Scroll Area** | Contenedor con scroll | `rx.scroll_area(scrollbars="horizontal")` |

---

¬°Listo! Ahora tienes una gu√≠a completa con todos los conceptos explicados detalladamente. üéâ
